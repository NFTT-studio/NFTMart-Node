# nftmart-keygen example

Files under this directory are generated by running the following command:

```
btwiuse@penguin:~/nftmart/.maintain$ bash nftmart-keygen 1 2                                                                                       
[INFO] 18:21:07 (main) cd /tmp/tmp.QiLOMRTcAW

[INFO] 18:21:07 (main->gen_root_and_session_keys) generating root key (root.json)
[INFO] 18:21:09 (main->gen_root_and_session_keys) generating session key (session.json)

[INFO] 18:21:12 (main->gen_stash_and_controller_keys) generating stash key for genesis node 1 (stash1.json)
[INFO] 18:21:15 (main->gen_stash_and_controller_keys) generating controller key for genesis node 1 (controller1.json)
[INFO] 18:21:19 (main->gen_stash_and_controller_keys) generating stash key for genesis node 2 (stash2.json)
[INFO] 18:21:22 (main->gen_stash_and_controller_keys) generating controller key for genesis node 2 (controller2.json)

[INFO] 18:21:25 (main->gen_inject_grandpa_and_babe_keys) generating inject grandpa key for node 1 (grandpa1.json)
[INFO] 18:21:28 (main->gen_inject_grandpa_and_babe_keys) generating inject babe key for node 1 (babe1.json)
[INFO] 18:21:31 (main->gen_inject_grandpa_and_babe_keys) generating inject grandpa key for node 2 (grandpa2.json)
[INFO] 18:21:34 (main->gen_inject_grandpa_and_babe_keys) generating inject babe key for node 2 (babe2.json)

[INFO] 18:21:37 (main->gen_inject_scripts) generating inject script for node 1 (inject1.sh)
[INFO] 18:21:37 (main->gen_inject_scripts) generating inject script for node 2 (inject2.sh)

[INFO] 18:21:37 (main->gen_node_key) generating node key for p2p node1: (node1_p2p_key, node1_p2p_peer_id)
[INFO] 18:21:40 (main->gen_node_key) generating node key for p2p node2: (node2_p2p_key, node2_p2p_peer_id)

[INFO] 18:21:43 (main->gen_rust) generating rust chain_spec.rs genesis config code snippet (chain_spec.rs)

[INFO] 18:21:43 (main->gen_summary) generating summary (summary.txt, summary.html)
```

After having these files generated, modify ./bin/node/cli/src/chain_spec.rs to match the content of `chain_spec.rs`, then recompile your node binary, copy the binary to `.maintain/docker` along with the new chain spec generated by running the following command, 

```
$ target/release/substrate build-spec --disable-default-bootnode --chain staging >bin/node/cli/res/staging_spec.json 
$ target/release/substrate build-spec --disable-default-bootnode --chain=bin/node/cli/res/staging_spec.json --raw >bin/node/cli/res/staging_spec_raw.json
```

and build a new docker image `btwiuse/nftmart:beta` using files under the directory

```
btwiuse@penguin:~/nftmart/.maintain$ make
```

Now start the nodes
```
$ docker-compose up
```

Wait a moment for your nodes to be up and running, (you can check their status from the prometheus console served at http://localhost:9090/targets), then open http://localhost:3000/ to view your grafana monitoring dashboards:
- [Substrate Networking](http://localhost:3000/d/substrate-networking/substrate-networking?orgId=1&refresh=1m&from=now-5m&to=now&var-nodename=node1:9615&var-nodename=node2:9616&var-nodename=node3:9617&var-notif_protocol=All&var-request_protocol=All&var-data_source=Prometheus&var-metric_namespace=substrate)
- [Substrate Service Tasks](http://localhost:3000/d/substrate-service-tasks/substrate-service-tasks?orgId=1&var-nodename=node1:9615&var-nodename=node2:9616&var-nodename=node3:9617&var-metric_namespace=substrate&var-data_source=Prometheus&from=now-5m&to=now)

TODO:
- connect to polkadot ui
